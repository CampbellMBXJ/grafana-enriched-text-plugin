{"version":3,"sources":["webpack:///webpack/bootstrap 72797bb16fb4f034b729","webpack:///./module.js","webpack:///external \"lodash\"","webpack:///external \"app/plugins/sdk\"","webpack:///./css/panel.base.scss","webpack:///./css/panel.dark.scss","webpack:///./css/panel.light.scss"],"names":["defaultContent","TagCtrl","$scope","$injector","templateSrv","$sce","panelDefaults","mode","content","data","defaults","events","on","onDataReceived","bind","onInitEditMode","onRefresh","onRender","render","parseContent","panel","renderingCompleted","dataLine","mod","datapoints","max","Infinity","point","addEditorTab","start","end","indexOf","line","tag","middle","start_offset","end_offset","substring","toLowerCase","getLine","newLine","allLines","tags","i","length","target","split","includes","push","metric","getTag","undefined","value","getDataValue","scope","element","initStyles","window","System","import","panelPath","grafanaBootData","user","lightTheme","_panelPath","pluginId","scrollable","templateUrl","PanelCtrl"],"mappings":"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","file":"module.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 72797bb16fb4f034b729","import _ from 'lodash';\nimport {\n    PanelCtrl,\n    MetricsPanelCtrl,\n    loadPluginCss\n} from 'grafana/app/plugins/sdk'; // will be resolved to app/plugins/sdk\nimport './css/panel.base.scss';\nimport './css/panel.dark.scss';\nimport './css/panel.light.scss';\n\nconst defaultContent = \"\\n<h4>Tittle</h4><p>Example Template</p>\\n{{{{Metrics: $(metric)-$(max(metricNum))}}}}\\n<p>use html tags in the template for styling\\n\";\n\nexport class TagCtrl extends MetricsPanelCtrl {\n\n    constructor($scope, $injector, templateSrv, $sce) {\n        super($scope, $injector);\n        this.panelDefaults = {\n            mode: 'html', // 'html', 'markdown', 'text'\n            content: defaultContent,\n            data: []\n        };\n        this.defaults();\n\n        this.events.on('data-received', this.onDataReceived.bind(this));\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n        this.events.on('refresh', this.onRefresh.bind(this));\n        this.events.on('render', this.onRender.bind(this));\n        // let renderWhenChanged = function(scope) {\n        //     let panel = scope.ctrl.panel;\n        //     return [\n        //         panel.content,\n        //         panel.mode\n        //     ].join();\n        // };\n        // $scope.$watch(renderWhenChanged, _.throttle(function() {\n        //     this.render();\n        // }, 100));\n    }\n\n    onRefresh() {\n        this.render()\n    }\n\n    onRender() {\n        this.parseContent(this.panel.content, this.data);\n        this.renderingCompleted();\n    }\n\n    onDataReceived(data) {\n        this.data = data;\n        this.parseContent(this.panel.content, this.data);\n    }\n\n    getDataValue(dataLine, mod) {\n        if (mod === \"first\") {\n            return dataLine.datapoints[0][0];\n        } else if (mod === \"max\") {\n            let max = [-Infinity];\n            for (let point in dataLine.datapoints) {\n                if (dataLine.datapoints[point][0] > max) {\n                    max = dataLine.datapoints[point];\n                }\n            }\n            return max[0]\n        }\n\n    }\n\n    onInitEditMode() {\n        this.addEditorTab('Options', 'public/app/plugins/panel/text/editor.html');\n    }\n\n    getLine() {\n        let start = 0;\n        let end = 0;\n        start = this.panel.content.indexOf(\"{{\");\n        end = this.panel.content.indexOf(\"}}\")\n        return [start + 2, end]\n    }\n\n    getTag(line, tag) {\n        let start = 0;\n        let end = 0;\n        let middle = 0;\n        while (start != -1) {\n            start = line.indexOf(\"$(\", start + 3);\n            if (start != -1) {\n                end = line.indexOf(\")\", start + 3);\n                if (end != -1) {\n                    let mod = \"first\";\n                    let start_offset = 2;\n                    let end_offset = 0;\n                    if (line.substring(start + start_offset, start + 6).toLowerCase() === \"max(\" && line[end + 1] === \")\") {\n                        start_offset = 6;\n                        end_offset = 1;\n                        mod = \"max\";\n                    }\n                    if (line.substring(start + start_offset, end) === tag) {\n                        return [start, end, start_offset, end_offset, mod]\n                    }\n                }\n            }\n        }\n    }\n\n    parseContent(content, data) {\n        let line = this.getLine();\n        let newLine = content.substring(line[0], line[1]);\n        let allLines = \"\";\n        let tags = [];\n        for (let i = 0; i < data.length; i++) {\n            let tag = data[i].target.split(\" \")[0].split(\".\")[1];\n            if (!tags.includes(tag)) {\n                tags.push(tag);\n            } else {\n                tags = [tag];\n                allLines += `${newLine}\\n`;\n                newLine = content.substring(line[0], line[1]);\n            }\n            let metric = this.getTag(newLine, tag);\n            while (metric !== undefined) {\n                let value = this.getDataValue(data[i], metric[4]);\n                newLine = newLine.substring(0, metric[0]) + value + newLine.substring(metric[1] + metric[3] + 1, newLine.length);\n                metric = this.getTag(newLine, tag);\n            }\n        }\n        this.content = content.substring(0, line[0] - 2) + allLines + newLine + content.substring(line[1] + 2, content.length);\n    }\n\n    defaults() {\n        if (this.panel.content === undefined || this.panel.content === undefined) {\n            this.panel.mode = this.panelDefaults.mode;\n            this.panel.content = this.panelDefaults.content;\n        }\n\n        if (this.panel.data === undefined) {\n            this.panel.data === this.panelDefaults.data;\n        }\n    }\n\n    link(scope, element) {\n        this.initStyles();\n    }\n\n    initStyles() {\n        window.System.import(this.panelPath + 'css/panel.base.css!');\n        if (grafanaBootData.user.lightTheme) {\n            window.System.import(this.panelPath + 'css/panel.light.css!');\n        } else {\n            window.System.import(this.panelPath + 'css/panel.dark.css!');\n        }\n    }\n\n    get panelPath() {\n        if (this._panelPath === undefined) {\n            this._panelPath = `/public/plugins/${this.pluginId}/`;\n        }\n        return this._panelPath;\n    }\n\n}\n\nTagCtrl.scrollable = true;\nTagCtrl.templateUrl = 'partials/module.html';\n\nexport {\n    TagCtrl as PanelCtrl\n}\n\n\n// WEBPACK FOOTER //\n// ./module.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"app/plugins/sdk\"\n// module id = 2\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/panel.base.scss\n// module id = 3\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/panel.dark.scss\n// module id = 4\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./css/panel.light.scss\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}